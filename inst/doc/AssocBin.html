<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Chris Salahub" />


<title>An Introduction to AssocBin</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">An Introduction to AssocBin</h1>
<h4 class="author">Chris Salahub</h4>



<p>The <code>AssocBin</code> package implements the core algorithm and
several helpers to measure the association between two variables using a
recursive binary partitioning (or binning) of the data. At each step,
the algorithm is provided with a list of bins that have edges, contained
points, and other features and then splits those bins which fail some
stopping checks. Though it is not forced by any function contained, it
is assumed the user will provide the algorithm with <em>ranked</em>
variables along each margin, as every helper function assumes this is
the case. The core logic of the test rests on the observation that
variable ranks will have a joint uniform density only under
independence.</p>
<p>This vignette will demonstrate how to set up, run, and process the
results from this core algorithm using some of the defined helpers. A
more complete description can be found in the associated pre-print, <a href="https://arxiv.org/abs/2311.08561" class="uri">https://arxiv.org/abs/2311.08561</a>. We begin by loading
the package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(AssocBin)</span></code></pre></div>
<p>Now we can move on to some simple examples to establish how the
algorithm works. We start by generating some independent data and taking
the ranks.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9023831</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>randx <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>randy <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">plot</span>(randx, randy)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>rankx <span class="ot">&lt;-</span> <span class="fu">rank</span>(randx, <span class="at">ties.method =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ranky <span class="ot">&lt;-</span> <span class="fu">rank</span>(randy, <span class="at">ties.method =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">plot</span>(rankx, ranky)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>With rank data in hand, we can work on setting up the algorithm. This
requires (minimally) three steps:</p>
<ol style="list-style-type: decimal">
<li>Defining the stop criteria</li>
<li>Defining a stopping function</li>
<li>Defining a splitting function</li>
</ol>
<p><code>AssocBin</code> has been built in a modular way so any of these
can be custom-defined and swapped into the algorithm by a user, but
helpers are provided for the suggested use case. Let’s look at how the
stop criteria are defined:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>criteria <span class="ot">&lt;-</span> <span class="fu">makeCriteria</span>(expn <span class="sc">&lt;=</span> <span class="dv">10</span>, n <span class="sc">==</span> <span class="dv">0</span>, depth <span class="sc">&gt;=</span> d)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">str</span>(criteria)</span></code></pre></div>
<pre><code>##  chr &quot;expn &lt;= 10 | n == 0 | depth &gt;= d | stopped&quot;</code></pre>
<p>The <code>makeCriteria</code> function captures its arguments and
appends them into a character separated by <code>|</code>. This creates
a single logical statement which is evaluated within each bin (treated
as an environment) to determine whether than bin’s named elements
satisfy the stop criteria. The wrapper that performs this evaluation is
<code>stopper</code>, which is set up by defining a closure using the
criteria:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>stopper</span></code></pre></div>
<pre><code>## function (binList, criteria) 
## {
##     sapply(binList, function(b) eval(parse(text = criteria), 
##         envir = b))
## }
## &lt;bytecode: 0x00000241eda90580&gt;
## &lt;environment: namespace:AssocBin&gt;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>stopFn <span class="ot">&lt;-</span> <span class="cf">function</span>(bns) <span class="fu">stopper</span>(bns, criteria)</span></code></pre></div>
<p>In this way, many criteria can be quickly checked and the
<code>makeCriteria</code> function can be adapted to changes in the
named elements of a bin. Note that <code>d</code> is not defined yet.
This is deliberate choice that allows us to use R’s lexical scoping to
set it dynamically and modify the depth criteria on the fly.</p>
<p>Next, we set up the splitting logic. The helper provided to support
different splitting logic is the <code>maxScoreSplit</code> function,
which accepts a bin, score function, and numeric value specifying the
minimum expected number of observations (proportional to the area)
allowed for bins to put a floor on the minimum bin size. It uses the
score function to evaluate splits at every observation in the bin and
chooses the one which maximizes the score subject to the minimum size
constraint. <code>chiScores</code> computes <span class="math inline">\(\chi^2\)</span> statistic-like scores based on
<span class="math display">\[\frac{(o - e)^2}{e}\]</span> where <span class="math inline">\(e\)</span> is the expected number of points in a
bin and <span class="math inline">\(o\)</span> is the observed number.
<code>miScores</code> instead takes inspiration from the mutual
information in <span class="math display">\[\frac{o}{n} \log
\frac{o}{e}.\]</span> Finally, <code>randScores</code> supports random
splitting by sampling random uniform values in place of computing a
score for each potential split. To set up their use, all can be placed
in appropriate closures.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>chiSplit <span class="ot">&lt;-</span> <span class="cf">function</span>(bn) <span class="fu">maxScoreSplit</span>(bn, chiScores, <span class="at">minExp =</span> <span class="dv">5</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>miSplit <span class="ot">&lt;-</span> <span class="cf">function</span>(bn) <span class="fu">maxScoreSplit</span>(bn, miScores, <span class="at">minExp =</span> <span class="dv">5</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>rndSplit <span class="ot">&lt;-</span> <span class="cf">function</span>(bn) <span class="fu">maxScoreSplit</span>(bn, randScores, <span class="at">minExp =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>With all the necessary preliminaries set up, we can apply the
algorithm to our data. This is done by using the <code>binner</code>
function with the appropriate arguments.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>randBin <span class="ot">&lt;-</span> <span class="fu">binner</span>(<span class="at">x =</span> rankx, <span class="at">y =</span> ranky, <span class="at">stopper =</span> stopFn, <span class="at">splitter =</span> chiSplit)</span></code></pre></div>
<p>We can visualize the result using the helper
<code>plotBinning</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">plotBinning</span>(randBin, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>            <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;gray50&quot;</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This plot is augmented by filling the displayed bins. The
<code>fill</code> argument to <code>plotBinning</code> accepts a vector
of colour values, but two useful cases are shading by residual and
shading by depth. These cases are completed by
<code>residualFill</code>, which computes the Pearson residual <span class="math display">\[\text{sign}(o - e)\sqrt{\frac{(o -
e)^2}{e}}\]</span> and uses a divergent palette to shade the bins.
Trying both for our simple data:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="do">## first fill by depth</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">plotBinning</span>(randBin, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>            <span class="at">fill =</span> <span class="fu">depthFill</span>(randBin),</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>            <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;gray50&quot;</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="do">## next fill by residual</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">plotBinning</span>(randBin, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>            <span class="at">fill =</span> <span class="fu">residualFill</span>(randBin, <span class="at">colrng =</span> <span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;firebrick&quot;</span>)),</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>            <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;gray50&quot;</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6kNtAQEBgYGBmAABmADpmZmZmtv9wcHB4eHiHh4ePj4+QOgCQZgCQ2/+fn5+2ZgC2/7a2//+/v7/bkDrb/9vb////tmb/25D//7b//9v///+WXm5/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMG0lEQVR4nO2d6XrjuBFFNd2ejOWkM5IzdNpK1Lbf/yVDEFywVOECEClByr0/+lMTIJZDoLAV6d0XldTu1gVoXQQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEArA9rdjW4FSA3pum7drC5Tc4C69/f3rQjVsG8NkOFTTCiz4lXsrwwo6Npxj98/G+2X/+/3cSThHhwrShrqFoCC5OJEgxaUeOhzs1luSZextHG2CchHkqjT4XgcA/7PAHkGRa/ToY82EsoFVGqDWgXkSgXUHTtDaGlCXVZymjEXA+4BUNDhlmp4gOaA2jLKTesuAHlQnGp074bQQUy0WFI77VO/D0CL/Gr0hI4hHyU5OEsSAJlL+7Ii3hLQUMVwAiBUW0wOm+YY0HDlOcuupTOvlwJIfNq2ihmjtDgoZgzuEcPGAC1UxKc9VRE3hVpA0XNpC9BiTuTKzFehMakGJN7Vig1yBiSnMsHolVfFShsk3rXxKPb5atd7334mkxsALVOaBUW04Ega53QZazeYtgR02v1hf5ynH3ru7pyvc/goM8RUe7i8lbswNwT0+TpjOX3/byK54V9nWTUVUF9iJLtbThmT7cnDvyGgj5cf08+z0sm0/aDL9nS8yookki3Qx99MC8oSalo2uQBlDDINOAgtK2KhDRqbUIYNytL84HNtkEKyOx6PegJXa0Gmk9mHoLSf0tzl8V9JNLzDlWvvhMSuZYOyk8vdwMmcCkFAwSZA3ByvNIolUtmVdHCv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" /><!-- --></p>
<p>The default shading highlights bins with Pearson residuals which are
significant at the asymptotic 95% critical values. Pearson residuals
less than -1.96 are shaded in blue and those greater than 1.96 are
shaded in red. Changing this behaviour to create different shading can
be completed by specifying custom colour break points and corresponding
colours or by specifying the number of breaks through the
<code>nbr</code> argument.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="do">## next fill by residual</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">plotBinning</span>(randBin, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>            <span class="at">fill =</span> <span class="fu">residualFill</span>(randBin, <span class="at">colrng =</span> <span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;firebrick&quot;</span>),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                                <span class="at">nbr =</span> <span class="dv">50</span>),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>            <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;gray50&quot;</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This fill is much more interesting when applied to a larger sample of
data which is not random and uniform.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>depx <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span>n)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>depy <span class="ot">&lt;-</span> depx <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span>n, <span class="at">sd =</span> <span class="fl">0.4</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">plot</span>(depx, depy)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># change maximum depth due to larger sample size</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>depx.rank <span class="ot">&lt;-</span> <span class="fu">rank</span>(depx)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>depy.rank <span class="ot">&lt;-</span> <span class="fu">rank</span>(depy)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>depBins <span class="ot">&lt;-</span> <span class="fu">binner</span>(depx.rank, depy.rank, <span class="at">stopper =</span> stopFn, <span class="at">splitter =</span> chiSplit)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">plotBinning</span>(depBins, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">plotBinning</span>(depBins, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>            <span class="at">fill =</span> <span class="fu">residualFill</span>(depBins))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The Pearson residuals, which use red to display areas of unusually
high density and blue for areas of unusually low density, effectively
highlight the pattern of the data and the regions which depart the most
from an assumption of uniformity (and therefore independence). Even
under random splitting they provide some idea of the structure in the
data (though the bins aren’t as regular).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">591241</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>depBins.rand <span class="ot">&lt;-</span> <span class="fu">binner</span>(depx.rank, depy.rank, <span class="at">stopper =</span> stopFn, <span class="at">splitter =</span> rndSplit)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">plotBinning</span>(depBins.rand, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="dv">1</span>, </span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>            <span class="at">fill =</span> <span class="fu">residualFill</span>(depBins.rand))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Once a binning has been completed, we can compute the <span class="math inline">\(\chi^2\)</span> statistic on the bins using
<code>binChi</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">binChi</span>(randBin)<span class="sc">$</span>stat</span></code></pre></div>
<pre><code>## [1] 15.45718</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">binChi</span>(depBins)<span class="sc">$</span>stat</span></code></pre></div>
<pre><code>## [1] 2468.06</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">binChi</span>(depBins.rand)<span class="sc">$</span>stat</span></code></pre></div>
<pre><code>## [1] 1341.251</code></pre>
<p>As might be expected, the statistic for the strongly dependent data
is much larger than for the uniform data and the maximizing splits
result in a larger statistic value than the random splits. These
statistics can then be used to rank different associations or to
generate a p-value. For more examples of the method in use, try
<code>demo(simulatedPatterns)</code> (which is fast) or
<code>demo(sp500)</code> (which takes a very long time to run due to the
size of the dataset).</p>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
